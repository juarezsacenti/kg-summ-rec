### BUILD:  docker build -t ripplenet:1.0 .
### RUN:    docker run --rm -it --gpus all ripplenet:1.0 $CMD

FROM tensorflow/tensorflow:1.4.0-gpu-py3
# CONTENT
# python=3.5.2
# numpy=1.13.3
# scipy=1.0.0
# tensorflow-gpu=1.4.0

# 1. Install git
RUN apt-get update
RUN apt-get install -y git

# 2. Download project
RUN git clone https://github.com/hwwang55/RippleNet.git

# 3. Adapt to CaseRecommender
RUN pip install -U git+git://github.com/caserec/CaseRecommender.git
RUN mv RippleNet/src/train.py RippleNet/src/train.py_ORIG
RUN mv RippleNet/src/preprocess.py RippleNet/src/preprocess.py_ORIG
COPY train.py /notebooks/RippleNet/src/train.py
COPY preprocess.py /notebooks/RippleNet/src/preprocess.py


# 4. Run application
# or --dataset book, use -h to check optional arguments in main.py
CMD cd RippleNet/src \
    && python3 preprocess.py --dataset movie \
    && python3 main.py --dataset movie
